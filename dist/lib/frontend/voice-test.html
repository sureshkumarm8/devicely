<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Input Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            margin: 10px;
            cursor: pointer;
        }
        #status {
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            min-height: 100px;
        }
        .listening { background: #ffe6e6; border-color: #ff0000; }
        .processing { background: #e6f3ff; border-color: #0066ff; }
        .result { background: #e6ffe6; border-color: #00ff00; }
        #logs {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üé§ Voice Input Test</h1>
    
    <button id="startBtn">Start Listening</button>
    <button id="stopBtn" disabled>Stop</button>
    
    <div id="status">
        <h3>Status: <span id="statusText">Ready</span></h3>
        <p><strong>Transcript:</strong> <span id="transcript">...</span></p>
        <p><strong>Is Final:</strong> <span id="isFinal">-</span></p>
    </div>
    
    <h3>Console Logs:</h3>
    <div id="logs"></div>
    
    <script>
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const statusDiv = document.getElementById('status');
        const statusText = document.getElementById('statusText');
        const transcriptSpan = document.getElementById('transcript');
        const isFinalSpan = document.getElementById('isFinal');
        const logsDiv = document.getElementById('logs');
        
        function log(msg, ...args) {
            console.log(msg, ...args);
            const time = new Date().toLocaleTimeString();
            logsDiv.innerHTML += `[${time}] ${msg} ${args.join(' ')}<br>`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }
        
        log('üîß Initializing...');
        
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        
        if (!SpeechRecognition) {
            log('‚ùå Speech Recognition NOT SUPPORTED');
            statusText.textContent = 'Not Supported';
            startBtn.disabled = true;
        } else {
            log('‚úÖ Speech Recognition API available');
            
            const recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = true;
            recognition.lang = 'en-US';
            
            log('‚öôÔ∏è Settings configured');
            
            recognition.onstart = () => {
                log('üé§ STARTED - Listening...');
                statusText.textContent = 'Listening...';
                statusDiv.className = 'listening';
                startBtn.disabled = true;
                stopBtn.disabled = false;
            };
            
            recognition.onresult = (event) => {
                log('üìù RESULT received');
                const result = event.results[event.results.length - 1];
                const transcript = result[0].transcript;
                const confidence = result[0].confidence;
                
                transcriptSpan.textContent = transcript;
                isFinalSpan.textContent = result.isFinal ? 'Yes' : 'No';
                
                if (result.isFinal) {
                    log('‚úÖ FINAL:', transcript, 'Confidence:', confidence);
                    statusText.textContent = 'Got Result!';
                    statusDiv.className = 'result';
                } else {
                    log('‚è≥ Interim:', transcript);
                }
            };
            
            recognition.onerror = (event) => {
                log('‚ùå ERROR:', event.error);
                statusText.textContent = 'Error: ' + event.error;
                statusDiv.className = '';
                startBtn.disabled = false;
                stopBtn.disabled = true;
            };
            
            recognition.onend = () => {
                log('üèÅ ENDED');
                statusText.textContent = 'Stopped';
                statusDiv.className = '';
                startBtn.disabled = false;
                stopBtn.disabled = true;
            };
            
            startBtn.onclick = () => {
                log('‚ñ∂Ô∏è Start button clicked');
                try {
                    recognition.start();
                    log('‚úÖ recognition.start() called');
                } catch (e) {
                    log('‚ùå Failed to start:', e.message);
                }
            };
            
            stopBtn.onclick = () => {
                log('‚èπÔ∏è Stop button clicked');
                try {
                    recognition.stop();
                    log('‚úÖ recognition.stop() called');
                } catch (e) {
                    log('‚ùå Failed to stop:', e.message);
                }
            };
            
            log('‚úÖ Ready to test!');
        }
    </script>
</body>
</html>
